## 概述

### 插件介绍

滤镜的作用范围非常广，它由滤镜核心，派生出许多子插件：

◆Drill_CoreOfFilter 系统 - 滤镜核心

以下是 **作用于单张贴图的滤镜** 插件：

◆Drill_EnemyFilter 单位 - 滤镜效果

◆Drill_EventFilter 行走图 - 滤镜效果

◆Drill_ItemTextFilter UI - 物品+技能文本的滤镜效果

◆Drill_PictureFilter 图片 - 滤镜效果

◆Drill_DialogFilter 对话框 - 滤镜效果

◆Drill_X\_BattleHudFilter 战斗UI - 角色窗口的滤镜效果\[扩展\]

◆Drill_X\_GaugeBossFilter UI - 高级BOSS框的滤镜效果\[扩展\]

◆Drill_X\_EventTextFilter 行走图 - 事件漂浮文字的滤镜效果\[扩展\]

以下是 **作用于整体的滤镜** 插件：

◆Drill_BattleFilter 战斗 - 滤镜效果

◆Drill_LayerFilter 地图 - 滤镜效果

◆Drill_X\_LayerColorFilter 地图 - 全图滤色镜\[扩展\]

### 插件关系

插件的从属关系如下图：

![](media/image2.emf)

其中，下面三个插件有相互额外扩展的关系：

![](media/image3.emf)

需要注意的是，虽然都属于滤镜家族，**但是插件里面的插件指令/注释，可能指令和参数的格式有很大区别**，注意区分。

## 滤镜的定义

### 滤镜（作用于单张贴图）

滤镜，是在资源图片的基础上，对资源图片进行额外处理的模块。

滤镜一般只作用于**单张贴图**。

需要注意的是，它**不会**改变资源图片的基本属性，如大小、透明度、图片位置等都不会发生变化。

![H:\\rpg mv
箱\\mog插件中文全翻译(Drill_up)v1.74\\插件集合示例\\img\\enemies\\小爱丽丝009.jpg](media/image4.jpeg){width="5.0in"
height="2.3316240157480315in"}

图中为纯色滤镜。

滤镜的种类有很多，在后面的章节分别有介绍。

### 滤镜（作用于整体）

滤镜还可以作用于整个游戏界面，或者某个图层下的所有贴图。

由于是对整体添加效果，并且能与单张贴图的滤镜效果叠加，**所以消耗性能非常大**。下图中测试的电脑帧数稳定在30帧，但是没有开滤镜时，帧数稳定在40帧左右。

![](media/image5.png){width="3.28125in" height="2.383464566929134in"}

作用于整体的滤镜功能也十分受限：

1.地图滤镜只能瞬间切换。

2.没有 波动滤镜 。

3.着色滤镜的程度只有0和255，中间过渡的1-254默认视为255。

从脚本层面，rmmv的核心库pixi提供了基本的下列几种滤镜，它们分别是：

遮罩滤镜（SpriteMaskFilter）

颜色矩阵滤镜（ColorMatrixFilter）

模糊滤镜（BlurFilter）

噪点滤镜（NoiseFilter）

抗锯齿滤镜（FXAAFilter）

置换滤镜（DisplacementFilter）

**考虑到实用性关系，插件中的滤镜
与脚本中初始定义的滤镜略有不同**。另外，pixi官方还提供了pixi-filter.js库，库中集合了更多其它有趣的滤镜效果，这里暂不考虑。

## 滤镜的种类

### 纯色滤镜

**纯色滤镜的效果与ps中的正片叠底效果一模一样**。

固定分为7种颜色：纯黑、纯蓝、纯绿、纯红、黄色、紫色、青色。

![](media/image6.png){width="5.768055555555556in"
height="2.8793547681539806in"}

（图中为滤镜程度开到255最大程度的效果）

光的三原色是：红、绿、蓝。

黄=红+绿。紫=红+蓝。青=蓝+绿。 白=红+蓝+绿。黑=什么颜色都没有。

设置滤色镜后，比如纯蓝，图片将只剩下的蓝色光线，因为黄色、紫色、绿色属于混合色，所以效果不太一样。

你需要适当调整透明度，对周围环境滤镜颜色进行微调。

### 着色滤镜

着色滤镜是在图像色彩信息的基础上，进行额外填色。

分为一下几种：黑白、反色、鲜艳
、漂白、饱和度降低、古墨水画色、古铜色、宝丽来相机色、红绿蓝翻转、夜色、致幻色。常用的一般为前面4种。

**反色**：反色与红绿蓝翻转不一样，反色是色彩值直接255取差值。而红绿蓝翻转，是红的色彩值给绿色，绿色的色彩值给蓝色，蓝色的色彩值给红色。

（从左至右依次为 原图、反色、红绿蓝翻转）

![](media/image7.png){width="5.768055555555556in"
height="2.0694444444444446in"}

需要一提的是，反色的实际效果，与ps的反相有出入。可能是由于程序内部的色彩矩阵算法不一样，ps中应该是黑色的部分被填充成了白色，使得反色的效果反而变亮了。

**漂白**：需要注意的是，漂白并不能使图像变亮，漂白是将整个图像的倾向于白色。与纯色滤镜搭配后，亮度仍然不变。

（从左至右依次为 原图、纯蓝、纯蓝+漂白）

![](media/image8.png){width="5.768055555555556in"
height="2.011111111111111in"}

### 填充滤镜

**填充滤镜的效果与ps中的油漆桶填充效果一模一样**。

含有8种颜色：纯黑、纯蓝、纯绿、纯红、黄色、紫色、青色、纯白。

并且支持自定义填充颜色（#ffaacc）。

填充滤镜会覆盖图片的**所有不透明区域**，含有背景的图片会被填充成矩形。

![](media/image9.png){width="5.275in" height="2.6451213910761155in"}

需要注意的是，全填充之后，只能看见影子，反而看不清脸了。

### 模糊滤镜

模糊滤镜是单独的滤镜，并没有种类划分。

模糊滤镜可以使得图像变的极其模糊。

### 噪点滤镜

模糊滤镜是单独的滤镜，并没有种类划分。

噪点滤镜会使得图像偏向于电视机花屏的效果。

**先后添加的滤镜效果**：

这里有一个比较有意思的是，先噪点后模糊，与先模糊后噪点，可以达到不一样的效果。

![](media/image10.png){width="3.850333552055993in"
height="1.3167804024496939in"}

![](media/image11.png){width="5.768055555555556in"
height="2.972916666666667in"}

为了控制先后顺序，这里必须要求等待一帧后再添加，如果同时添加，则只有默认的滤镜顺序。

## 滤镜的变化属性

滤镜根据程度，这里固定范围为0-255。255的程度最强烈，0的程度为完全关闭滤镜的情况。

### 线性滤镜

插件指令默认都是线性滤镜，功能为：变化到目标程度后，一直保持滤镜情况。

线性滤镜需要两个参数，即目标程度（0-255）和变化时长（单位帧）。

![F:\\rpg
mv箱\\D_HEO@%\`1(\[\~A\[\$9\~4I()WA.jpg](media/image12.jpeg){width="3.8666666666666667in"
height="1.6413079615048118in"}

### 波动滤镜

波动滤镜与线性滤镜不一样，由于不存在保持滤镜颜色的时间，所以开启关闭时，波动滤镜都是瞬间切换。

波动滤镜需要两个参数，即范围（0-255）、周期（波动一次所需时间，单位帧）

![F:\\rpg
mv箱\\)Q0IAGB\$4\@H0\~BA}I}CTM28.jpg](media/image13.jpeg){width="3.908333333333333in"
height="2.264484908136483in"}

## 其他说明

### 性能影响

滤镜是**性能消耗大户**，因为带滤镜的图片效果都是通过即时演算形成的。

性能测试中并不能准确找到该插件的消耗量，只能通过update总消耗量相减来进行估算。所以误差会比较大。

具体性能数据你可以去看看"性能测试统计表(滤镜).xlsx"。

![](media/image14.png){width="5.433333333333334in"
height="2.4085640857392825in"}
